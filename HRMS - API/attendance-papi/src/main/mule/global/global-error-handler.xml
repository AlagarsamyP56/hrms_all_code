<?xml version="1.0" encoding="UTF-8"?>

<mule  xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
 ">
	<sub-flow name="commonError" doc:id="5be76457-5623-4589-b38f-728fe1aa2cba" >
		<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{&#10;  errorType: error.errorType.identifier  ,&#10;  timestamp: (now() &gt;&gt; "IST" as String {format: "yyyy-MM-dd HH:mm:ss.SSS"}),&#10;  errorDescription: error.detailedDescription&#10;  &#10;}]' doc:name="Set Payload" doc:id="4120f1f8-9a39-44eb-bd9e-736f7019f57a" />
		<logger level="INFO" doc:name="Logger" doc:id="c053c8c5-7fe2-438f-ad0e-0e31d2e191aa" message='#[%dw 2.0&#10;output application/json&#10;---&#10;{&#10;  errorType: error.errorType.identifier  ,&#10;  timestamp: (now() &gt;&gt; "IST" as String {format: "yyyy-MM-dd HH:mm:ss.SSS"}),&#10;  errorDescription: error.detailedDescription&#10;  &#10;}]'/>
	</sub-flow>
	<error-handler name="main-errorHandler" doc:id="c950d62e-f668-450f-879c-794896d4235b" >
		<on-error-propagate type="APIKIT:BAD_REQUEST">
			<set-variable value="400" doc:name=" HTTP Status Variable" doc:id="5e37497c-1a24-4dd0-89a0-32a704fb67e3" variableName="httpStatus"/>
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Bad request",&#10;statusCode: 400&#10;}]' doc:name="Bad request" doc:id="fba5cb30-c379-4b6a-b9f2-8ac6bb557980" />
            
</on-error-propagate>
		<on-error-propagate type="APIKIT:NOT_FOUND">
			<set-variable value="404" doc:name=" HTTP Status Variable" doc:id="5cf6a076-5e3e-4b8d-9824-520f6906ef70" variableName="httpStatus" />
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Resource not found",statusCode: 404}]' doc:name="Resource not found" doc:id="ed475432-741a-4792-a423-e9c5310ed620" />
            
</on-error-propagate>
		<on-error-propagate type="APIKIT:METHOD_NOT_ALLOWED">
			<set-variable value="405" doc:name=" HTTP Status Variable" doc:id="b3c8d55f-bf32-4371-95cf-e7225aafd2fc" variableName="httpStatus" />
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Method not allowed",statusCode: 405}]' doc:name="Method not allowed" doc:id="f2b5a571-2b26-4ca1-91c4-f718e10b0554" />
            
</on-error-propagate>
		<on-error-propagate type="APIKIT:NOT_ACCEPTABLE">
			<set-variable value="406" doc:name=" HTTP Status Variable" doc:id="6a95d675-e477-4b49-9faf-6fe94b294ef4" variableName="httpStatus" />
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Not acceptable",&#10;	statusCode: 406&#10;}]' doc:name="Not acceptable" doc:id="0eb87b0b-6254-4447-96b8-cad928abad4d" />
            
</on-error-propagate>
		<on-error-propagate type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
			<set-variable value="415" doc:name=" HTTP Status Variable" doc:id="5633ad6f-e9f9-4bff-9c88-b0ebdecd06df" variableName="httpStatus" />
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Unsupported media type",statusCode: 415}]' doc:name="Unsupported media type" doc:id="a17736ef-2aaa-450e-918d-4f2b6857be60" />
            
</on-error-propagate>
		<on-error-propagate type="APIKIT:NOT_IMPLEMENTED">
			<set-variable value="501" doc:name=" HTTP Status Variable" doc:id="972db17c-235e-475a-8f66-079f607b0fb7" variableName="httpStatus" />
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Not Implemented",&#10;	statusCode: 501&#10;}]' doc:name="Not Implemented" doc:id="c1f36786-e949-4c39-9a25-35f93e57dccc" />
            
</on-error-propagate>
	</error-handler>
	
	
	<error-handler name="console-errorHandler" doc:id="1bce4d96-7d96-458d-962f-a5b59e0e98a2"><on-error-propagate type="APIKIT:NOT_FOUND">
			<set-variable value="404" doc:name="Set Variable" doc:id="21b8813a-6291-428e-83ee-a3c1c10dbe42" variableName="httpStatus"/>
			<set-payload value='#[%dw 2.0&#10;output application/json&#10;---&#10;{message: "Resource not found"}]' doc:name="Resource not found" doc:id="52a8ec5f-fcea-439c-86b2-a22a0d16e5ab" />
            
</on-error-propagate>
	

</error-handler>
	<error-handler name="request-errorHandler" doc:id="a744aa77-022a-4969-b80a-b254653dfbb1" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="c05795e9-4f9c-4eea-aa90-a840db953851" type="HTTP:CONNECTIVITY, HTTP:RETRY_EXHAUSTED">
			<flow-ref doc:name="commonError" doc:id="adc86d98-c6d2-4648-9824-b37bd5b71d33" name="commonError"/>
		</on-error-propagate>
		<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="027735d3-5320-4791-ad9e-078689913b41" type="ANY">
			<flow-ref doc:name="commonError" doc:id="73c86756-4458-4704-bfba-7e2df5d7043f" name="commonError" />
		</on-error-continue>
	</error-handler>
</mule>
